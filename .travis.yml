dist: trusty
env:
  - CTEST_OUTPUT_ON_FAILURE=1
os:
- linux
language: cpp

addons:
  sonarcloud:
    organization: "gordon01"
    token:
      secure: "U058ItRLrlMZNu6755SRPs8/OedZotAdyT7doS/R2KWkTtL1iVOXisWQWSQrNbpc2Bj7iIA+Oq0KfCVwzpbme1t9E8Mb8trYpEIgiU4fZuwnudSxUE2pGm8VZCwk+Z7Ev8VgOiOIbYSF7epB5LGkcXQNealI/VQMU8U0dhQ5efw1srKfsRL1ZasH8+84jF3nDaUFG0dJg4WoKX0yHuMbYz9jV0xvDQ1koCF7g7QO1j4ujWryNSgyxO+9XydmL7Y7SAXNmq/Vx9ztpUYETJvPStcscs+TysnjFAHoGULIs+4ITyAysNC3N8/ftbOFmJ/RxG3AyG0IHzm6m7FXOKda11zat+hLgfUeSnIdpC08+ccGHdHSd3Jr56zGexpqWlI2TJKakxnFMd7Xu49GLTBeUw6VNQq6tANCA1HPqZGfW2pkmH7nF8v1rkXwawlChhrvyvATFt3wYusnyVMZ7UMtdramEMJD8KtgntyflcEtwcgHhfNPj9yD3pOIDRmpBQOxyZ7CMzy/f0fbM1pgaFOUrakRZbCwiyxfH6lgJJbdSil1HZ+J/CH6ujuBxmSa36hgUNAwAvQB5/C5YgTCrREseQUccRHladgCu+rmg7r9L0AcdkvBRfjLWewXwSNYbzgs3j7kOVew08wsBYM8nYySsBZitIc9HdqJgE01NW8owsM="

matrix:
  include:
    - compiler: gcc
      script:
        - mkdir build
        - cd build
        - cmake ../tests
        - build-wrapper-linux-x86-64 --out-dir ../bw-output make all
        - ./tests 
        - find CMakeFiles/tests.dir/ -name 'WVT_Water7.c.*' -type f -print -exec mv -f {} .. \;
        - cd ..
        - gcov lib/WVT_Water7.c --object-file WVT_Water7*gcda --object-file WVT_Water7*gcno
        - sonar-scanner

    - compiler: clang
      script:
        - mkdir build
        - cd build
        - cmake ../tests
        - make all
        - ./tests 
